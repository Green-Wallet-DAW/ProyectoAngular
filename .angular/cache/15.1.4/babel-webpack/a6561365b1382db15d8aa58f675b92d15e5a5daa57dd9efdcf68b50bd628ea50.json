{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nlet LoginComponent = class LoginComponent {\n  constructor(authService, tokenStorage) {\n    this.authService = authService;\n    this.tokenStorage = tokenStorage;\n    this.form = {\n      email: null,\n      password: null\n    };\n    this.isLoggedIn = false;\n    this.isLoginFailed = false;\n    this.errorMessage = '';\n    this.roles = [];\n  }\n  ngOnInit() {\n    if (this.tokenStorage.getToken()) {\n      this.isLoggedIn = true;\n      this.roles = this.tokenStorage.getUser().roles;\n    }\n  }\n  onSubmit() {\n    const {\n      email,\n      password\n    } = this.form;\n    this.authService.login(email, password).subscribe(data => {\n      console.log(JSON.stringify(data));\n      this.tokenStorage.saveToken(data.success.token);\n      this.tokenStorage.saveUser(data);\n      this.isLoginFailed = false;\n      this.isLoggedIn = true;\n      this.roles = this.tokenStorage.getUser().roles;\n      this.reloadPage();\n    }, err => {\n      this.errorMessage = err.error.message;\n      this.isLoginFailed = true;\n    });\n  }\n  reloadPage() {\n    window.location.reload();\n  }\n};\nLoginComponent = __decorate([Component({\n  selector: 'app-login',\n  templateUrl: './login.component.html',\n  styleUrls: ['./login.component.css']\n})], LoginComponent);\nexport { LoginComponent };","map":{"version":3,"mappings":";AAAA,SAASA,SAAS,QAAgB,eAAe;AAS1C,IAAMC,cAAc,GAApB,MAAMA,cAAc;EAUzBC,YAAoBC,WAAwB,EAAUC,YAAiC;IAAnE,gBAAW,GAAXD,WAAW;IAAuB,iBAAY,GAAZC,YAAY;IATlE,SAAI,GAAQ;MACVC,KAAK,EAAE,IAAI;MACXC,QAAQ,EAAE;KACX;IACD,eAAU,GAAG,KAAK;IAClB,kBAAa,GAAG,KAAK;IACrB,iBAAY,GAAG,EAAE;IACjB,UAAK,GAAa,EAAE;EAEuE;EAE3FC,QAAQ;IACN,IAAI,IAAI,CAACH,YAAY,CAACI,QAAQ,EAAE,EAAE;MAChC,IAAI,CAACC,UAAU,GAAG,IAAI;MACtB,IAAI,CAACC,KAAK,GAAG,IAAI,CAACN,YAAY,CAACO,OAAO,EAAE,CAACD,KAAK;;EAElD;EAEAE,QAAQ;IACN,MAAM;MAAEP,KAAK;MAAEC;IAAQ,CAAE,GAAG,IAAI,CAACO,IAAI;IAErC,IAAI,CAACV,WAAW,CAACW,KAAK,CAACT,KAAK,EAAEC,QAAQ,CAAC,CAACS,SAAS,CAC/CC,IAAI,IAAG;MACLC,OAAO,CAACC,GAAG,CAACC,IAAI,CAACC,SAAS,CAACJ,IAAI,CAAC,CAAC;MACjC,IAAI,CAACZ,YAAY,CAACiB,SAAS,CAACL,IAAI,CAACM,OAAO,CAACC,KAAK,CAAC;MAC/C,IAAI,CAACnB,YAAY,CAACoB,QAAQ,CAACR,IAAI,CAAC;MAEhC,IAAI,CAACS,aAAa,GAAG,KAAK;MAC1B,IAAI,CAAChB,UAAU,GAAG,IAAI;MACtB,IAAI,CAACC,KAAK,GAAG,IAAI,CAACN,YAAY,CAACO,OAAO,EAAE,CAACD,KAAK;MAC9C,IAAI,CAACgB,UAAU,EAAE;IAEnB,CAAC,EACDC,GAAG,IAAG;MACJ,IAAI,CAACC,YAAY,GAAGD,GAAG,CAACE,KAAK,CAACC,OAAO;MACrC,IAAI,CAACL,aAAa,GAAG,IAAI;IAC3B,CAAC,CACA;EACH;EAEAC,UAAU;IACRK,MAAM,CAACC,QAAQ,CAACC,MAAM,EAAE;EAC1B;CAEH;AA7CYhC,cAAc,eAL1BD,SAAS,CAAC;EACTkC,QAAQ,EAAE,WAAW;EACrBC,WAAW,EAAE,wBAAwB;EACrCC,SAAS,EAAE,CAAC,uBAAuB;CACpC,CAAC,GACWnC,cAAc,CA6C1B;SA7CYA,cAAc","names":["Component","LoginComponent","constructor","authService","tokenStorage","email","password","ngOnInit","getToken","isLoggedIn","roles","getUser","onSubmit","form","login","subscribe","data","console","log","JSON","stringify","saveToken","success","token","saveUser","isLoginFailed","reloadPage","err","errorMessage","error","message","window","location","reload","selector","templateUrl","styleUrls"],"sourceRoot":"","sources":["/home/alumno/Escritorio/GreenWallet/ProyectoAngular/src/app/login/login.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { AuthService } from '../_services/auth.service';\nimport { TokenStorageService } from '../_services/token-storage.service';\n\n@Component({\n  selector: 'app-login',\n  templateUrl: './login.component.html',\n  styleUrls: ['./login.component.css']\n})\nexport class LoginComponent implements OnInit {\n  form: any = {\n    email: null,\n    password: null\n  };\n  isLoggedIn = false;\n  isLoginFailed = false;\n  errorMessage = '';\n  roles: string[] = [];\n\n  constructor(private authService: AuthService, private tokenStorage: TokenStorageService) { }\n\n  ngOnInit(): void {\n    if (this.tokenStorage.getToken()) {\n      this.isLoggedIn = true;\n      this.roles = this.tokenStorage.getUser().roles;\n    }\n  }\n\n  onSubmit(): void {\n    const { email, password } = this.form;\n\n    this.authService.login(email, password).subscribe(\n      data => {\n        console.log(JSON.stringify(data));\n        this.tokenStorage.saveToken(data.success.token);\n        this.tokenStorage.saveUser(data);\n\n        this.isLoginFailed = false;\n        this.isLoggedIn = true;\n        this.roles = this.tokenStorage.getUser().roles;\n        this.reloadPage();\n        \n      },\n      err => {\n        this.errorMessage = err.error.message;\n        this.isLoginFailed = true;\n      }\n      );\n    }\n    \n    reloadPage(): void { \n      window.location.reload();\n    }\n\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}